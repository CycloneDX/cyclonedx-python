{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://cyclonedx.org/schema/ext/vulnerability-1.0-SNAPSHOT.schema.json",
  "type": "object",
  "title": "CycloneDX Vulnerability Extension",
  "$comment" : "CycloneDX Vulnerability Extension for JSON Schema is published under the terms of the Apache License 2.0.",
  "properties": {
    "vulnerabilities": {
      "$id": "#/properties/vulnerabilities",
      "type": "array",
      "items": {"$ref": "#/definitions/vulnerability"},
      "title": "Vulnerabilities",
      "description": "Defines a list of vulnerabilities."
    }
  },
  "definitions": {
    "cwe": {
      "type": "integer",
      "minimum": 1,
      "title": "CWE",
      "description": "Integer representation of a Common Weaknesses Enumerations (CWE). For example 399 (of https://cwe.mitre.org/data/definitions/399.html)"
    },
    "severity": {
      "type": "string",
      "title": "Severity",
      "description": "Textual representation of the severity of the vulnerability adopted by the risk analysis method. If an other risk analysis method is used other than whats defined in scoreSourceType, the user is expected to translate appropriately to match with an element value below.",
      "enum": [
        "None",
        "Low",
        "Medium",
        "High",
        "Critical",
        "Unknown"
      ]
    },
    "scoreValue": {
      "type": "number",
      "title": "Score",
      "description": "Numerical representation of the vulnerability score. Must be a number between 0 - 10 (maps to lowest severity - highest severity)",
      "multipleOf": 0.1,
      "examples": [7.9, 10.0]
    },
    "scoreSource": {
      "type": "string",
      "title": "Source",
      "description": "Specifies the risk scoring methodology/standard used.",
      "enum": [
        "CVSSv2",
        "CVSSv3",
        "OWASP Risk",
        "Open FAIR",
        "Other"
      ]
    },
    "score": {
      "type": "object",
      "title": "Score",
      "description": "Defines the numerical risk score of a vulnerability",
      "properties": {
        "base": {
          "type": "number",
          "title": "Base Score",
          "description": "The base score of the security vulnerability (Refer CVSS standard for example)",
          "multipleOf": 0.1,
          "examples": [2.9, 7.2]
        },
        "impact": {
          "type": "number",
          "title": "Impact Score",
          "description": "The impact subscore of the security vulnerability (Refer CVSS standard for example)",
          "multipleOf": 0.1,
          "examples": [2.9, 7.2]
        },
        "exploitability": {
          "type": "number",
          "title": "Exploitability Score",
          "description": "The exploitability subscore of the security vulnerability (Refer CVSS standard for example)",
          "multipleOf": 0.1,
          "examples": [2.9, 7.2]
        }
      }
    },
    "rating": {
      "type": "object",
      "title": "Rating",
      "description": "Defines the risk rating of a vulnerability.",
      "properties": {
        "score": {
          "$ref": "#/definitions/score"
        },
        "severity": {
          "$ref": "#/definitions/severity"
        },
        "method": {
          "$ref": "#/definitions/scoreSource"
        },
        "vector": {
          "type": "string",
          "title": "Vector",
          "description": "Textual representation of the metric values used to score the vulnerability see attack vector in https://www.first.org/cvss/v3.1/specification-document"
        }
      }
    },
    "source": {
      "type": "object",
      "title": "Source",
      "description": "The source of the vulnerability where it is documented. Usually the name of the organization publishing vulnerability information",
      "properties": {
        "url": {
          "type": "string",
          "title": "URL",
          "description": "The url of the vulnerability documentation as provided by the source.",
          "examples": [
            "https://nvd.nist.gov/vuln/detail/CVE-2019-15842"
          ]
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "The name of the source.",
          "examples": [
            "NVD", "National Vulnerability Database", "OSS Index", "VulnDB", "NPM Advisories"
          ]
        }
      }
    },
    "vulnerability": {
      "type": "object",
      "title": "Vulnerability",
      "description": "Defines the structure of a vulnerability.",
      "properties": {
        "ref": {
          "type": "string",
          "format": "string",
          "title": "Reference",
          "description": "References a component by the components bom-ref attribute"
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "The id of the vulnerability as defined by the risk scoring methodology. For example CVE-2019-15842 (of https://nvd.nist.gov/vuln/detail/CVE-2019-15842)"
        },
        "source": {
          "$ref": "#/definitions/source"
        },
        "ratings": {
          "type": "array",
          "title": "Ratings",
          "description": "List of the vulnerability ratings as defined by various risk rating methodologies.",
          "items": {"$ref": "#/definitions/rating"}
        },
        "cwes": {
          "type": "array",
          "title": "CWEs",
          "description": "List of Common Weaknesses Enumerations (CWEs) codes that describes this vulnerability. For example 399 (of https://cwe.mitre.org/data/definitions/399.html)",
          "items": {"$ref": "#/definitions/cwe"}
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description of the vulnerability as provided by the source organization"
        },
        "recommendations": {
          "type": "array",
          "title": "Recommendations",
          "description": "List of recommendations of how the particular vulnerability can be avoided/mitigated.",
          "items": {
            "type": "string"
          }
        },
        "advisories": {
          "type": "array",
          "title": "Advisories",
          "description": "Published advisories of the vulnerability if provided.",
          "items": {
            "type": "string"
          }
        }
      }
    }
  }
}
